<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- Metatags para SEO e Compartilhamento -->
    <title>Girando a Ampulheta da Vida - Podcast</title>
    <meta
      name="description"
      content="Explore temas profundos com os podcasts de Girando a Ampulheta da Vida. Educação, empatia e suporte!"
    />

    <meta property="og:title" content="Girando a Ampulheta da Vida - Podcast" />
    <meta
      property="og:description"
      content="Explore temas profundos com os podcasts de Girando a Ampulheta da Vida. Educação, empatia e suporte!"
    />
    <meta
      property="og:image"
      content="https://i.pinimg.com/originals/33/9d/0c/339d0cc2f05bbb719debe6a5efb414dd.jpg"
    />
    <meta property="og:url" content="https://ricmurtapsicologia.github.io/Podcast-ATS-CBMMG/" />

    <link
      rel="icon"
      href="https://i.pinimg.com/originals/33/9d/0c/339d0cc2f05bbb719debe6a5efb414dd.jpg"
      type="image/x-icon"
    />

    <!-- Performance hints -->
    <link rel="preconnect" href="https://i.pinimg.com" crossorigin />
    <link rel="preconnect" href="https://raw.githubusercontent.com" crossorigin />
    <link rel="preconnect" href="https://github.com" crossorigin />
    <meta name="theme-color" content="#005f73" />

    <!-- Google Analytics GA4 -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-N1GEBDNZ8B"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }
      gtag("js", new Date());
      gtag("config", "G-N1GEBDNZ8B");
    </script>

    <!-- Estilos -->
    <style>
      :root {
        --brand: #005f73;
        --brand-2: #003f5c;
        --accent: #ff8c00;
        --text: #333;
        --white: #fff;
        --card: rgba(255, 255, 255, 0.94);
        --shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
        --radius: 14px;
      }

      /* RESET & BASE */
      *, *::before, *::after { box-sizing: border-box; }
      html { scroll-behavior: smooth; }
      body {
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        margin: 0;
        color: var(--text);
        line-height: 1.6;
        /* Fundo "fogo" aplicado ao body para ficar atrás dos elementos */
        background: url("https://i.pinimg.com/originals/38/70/c5/3870c5a678e72a0c16ca58914e14df3f.jpg")
          no-repeat center center fixed;
        background-size: cover;
      }

      a { text-decoration: none; color: inherit; }

      /* Acessibilidade: foco visível */
      :focus-visible {
        outline: 3px solid var(--accent);
        outline-offset: 2px;
        border-radius: 8px;
      }

      /* Cabeçalho */
      header {
        background: rgba(0, 0, 0, 0.8);
        color: var(--white);
        padding: 24px 16px;
        text-align: center;
      }
      header h1 {
        margin: 0;
        font-size: clamp(1.6rem, 2.2vw + 1rem, 2.6rem);
        text-shadow: 2px 2px 5px rgba(0, 0, 0, 0.5);
      }

      /* Seção de Introdução */
      .intro-section { text-align: center; margin: 0 auto; }
      .intro-button {
        display: inline-flex; align-items: center; gap: 10px;
        background-color: var(--brand); color: var(--white);
        padding: 14px 26px; border-radius: 12px; font-size: 1.1rem; font-weight: 700;
        box-shadow: 0 3px 6px rgba(0, 0, 0, 0.3);
        margin: 26px auto 18px; cursor: pointer; text-align: center;
        animation: pulse 2.6s ease-in-out infinite;
        border: 0;
      }
      .intro-button img { width: 24px; height: 24px; }
      .intro-button:hover { transform: translateY(-2px); box-shadow: var(--shadow); }

      #intro-container {
        display: none; padding: 20px; max-width: 900px; margin: 20px auto;
        background: var(--card); backdrop-filter: blur(6px);
        border-radius: var(--radius); box-shadow: var(--shadow);
        color: var(--text); text-align: justify; font-size: 1.08rem; line-height: 1.8;
      }

      /* Pastas (CSS Grid) */
      .folders-container {
        display: grid; grid-template-columns: repeat(auto-fit, minmax(290px, 1fr));
        gap: 20px; padding: 20px; max-width: 1200px; margin: 0 auto 10px;
      }
      .folder {
        background: var(--card); box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        border-radius: var(--radius); text-align: center; padding: 15px; cursor: pointer;
        transition: transform 0.25s, box-shadow 0.25s; border: 1px solid rgba(0, 0, 0, 0.04);
      }
      .folder:hover { transform: translateY(-6px); box-shadow: var(--shadow); }
      .folder img { width: 100%; height: 240px; border-radius: 10px; object-fit: cover; }
      .folder h2 { font-size: 1.24rem; color: #006400; margin: 10px 0; }

      /* Áudios */
      .audio-container {
        display: none; padding: 20px; background: var(--card); border-radius: var(--radius);
        box-shadow: var(--shadow); max-width: 900px; margin: 0 auto 30px;
      }
      .audio-section { margin-bottom: 20px; }
      .audio-section h3 { font-size: 1.06rem; color: var(--brand); margin: 0 0 8px; }
      .audio-controls audio { width: 100%; display: block; border-radius: 6px; }
      .audio-meta { font-size: 0.92rem; color: #444; margin-top: 6px; display: flex; justify-content: space-between; gap: 12px; flex-wrap: wrap; }
      .audio-meta button { border: 0; background: transparent; color: var(--brand); cursor: pointer; text-decoration: underline; }

      .tip { font-size: 0.9rem; color: #222; background: #fffbe6; border: 1px solid #fff0b3; padding: 10px 12px; border-radius: 10px; margin: 10px 0 16px; }

      /* Feedback */
      .feedback-section { margin: 20px 0 40px; text-align: center; }
      .feedback-section p { font-size: 1.1rem; color: #fff; text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.7); margin-bottom: 10px; }
      .feedback-button {
        display: inline-flex; align-items: center; gap: 10px; background-color: var(--brand); color: var(--white);
        padding: 14px 26px; border-radius: 15px; font-size: 1.1rem; font-weight: 700; box-shadow: 0 3px 6px rgba(0, 0, 0, 0.3);
        border: none; cursor: pointer; margin: 20px auto;
      }
      .feedback-button:hover { transform: translateY(-2px); box-shadow: var(--shadow); }

      /* Footer */
      footer { background: rgba(0, 0, 0, 0.8); color: var(--white); text-align: center; padding: 20px; font-size: 0.95rem; }
      footer p { margin: 6px 0; }
      footer p:first-child { font-weight: 700; }

      /* Animações */
      @keyframes pulse { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.03); } }
      @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

      /* Onboarding */
      .onboarding {
        position: fixed; inset: 0; background-color: var(--brand); display: none; flex-direction: column;
        align-items: center; justify-content: center; color: var(--white); text-align: center; z-index: 9999; padding: 20px;
      }
      .onboarding p { font-size: clamp(1.2rem, 1.2rem + 1.2vw, 1.8rem); margin: 0 20px 20px; line-height: 1.4; }
      .onboard-buttons { display: flex; gap: 12px; margin-top: 16px; flex-wrap: wrap; justify-content: center; }
      .onboarding button { padding: 10px 20px; font-size: 1rem; font-weight: 700; border: none; border-radius: 8px; cursor: pointer; background: #fff; color: var(--brand); box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2); }
      .onboarding button:hover { transform: translateY(-1px); }
      .onboarding .muted { background: #073642; color: #cde; }
      .onboarding .muted:hover { filter: brightness(1.1); }
      .onboarding label { display: inline-flex; align-items: center; gap: 8px; font-size: 0.95rem; margin-top: 10px; }

      /* Botão Voltar às Pastas */
      .back-to-folders {
        display: inline-flex; align-items: center; gap: 10px; background-color: var(--brand); color: var(--white);
        padding: 12px 22px; border-radius: 25px; font-size: 1.06rem; font-weight: 700; box-shadow: 0 3px 6px rgba(0, 0, 0, 0.3);
        border: none; cursor: pointer; margin: 8px auto 0; }
      .back-to-folders:hover { background-color: var(--brand-2); transform: translateY(-2px); }

      /* Responsividade - Mobile First */
      @media (max-width: 768px) {
        #intro-container, .audio-container { max-width: 92%; margin: 20px auto; padding: 14px; }
        .feedback-button, .intro-button { width: auto; padding: 12px 20px; }
        header h1 { font-size: 1.6rem; }
        footer { display: block; }
      }

      /* Reduzir animações para usuários com preferência */
      @media (prefers-reduced-motion: reduce) {
        * { animation: none !important; transition: none !important; }
      }
    </style>

    <!-- CSS externo opcional -->
    <link rel="stylesheet" href="styles.css" />
  </head>

  <body>
    <noscript>
      <div style="background:#fffbe6;border:1px solid #ffe58f;padding:12px 14px;margin:10px;text-align:center;border-radius:10px">
        Este site usa JavaScript para carregar a lista de áudios. Ative o JavaScript para ouvir os episódios.
      </div>
    </noscript>

    <!-- Onboarding -->
    <div class="onboarding" id="onboarding" aria-label="Onboarding do projeto">
      <div class="onboard-content" id="onboard-content">
        <div class="onboard-slide" id="slide-1"><p>Bem-vindo(a)! Aguarde... sua imersão em conhecimento começa agora.</p></div>
        <div class="onboard-slide" id="slide-2" style="display:none"><p>Descubra técnicas exclusivas para abordar perfis de tentantes.</p></div>
        <div class="onboard-slide" id="slide-3" style="display:none"><p>Ouça áudios impactantes e amplie sua expertise técnica.</p></div>
        <div class="onboard-slide" id="slide-4" style="display:none"><p>Entenda engrenagens do comportamento suicida com clareza absoluta.</p></div>
        <div class="onboard-slide" id="slide-5" style="display:none"><p>Inicie a imersão e transforme sua prática profissional hoje.</p></div>
      </div>
      <div class="onboard-buttons">
        <button id="onboard-prev" class="muted" aria-label="Voltar">Voltar</button>
        <button id="onboard-next" aria-label="Seguir">Seguir</button>
        <button id="onboard-skip" class="muted" aria-label="Pular">Pular</button>
      </div>
      <label><input type="checkbox" id="dont-show-again" /> Não mostrar novamente</label>
    </div>

    <header>
      <h1>Girando a Ampulheta da Vida</h1>
    </header>

    <main>
      <section class="intro-section">
        <button type="button" class="intro-button" id="intro-btn" aria-expanded="false">
          <img src="https://img.icons8.com/ios-filled/50/ffffff/idea.png" alt="Introdução" loading="lazy" />
          Clique aqui para conhecer o Projeto Agora!
        </button>

        <div id="intro-container" aria-live="polite">
          <p><strong>Saudações, caro abordador!</strong></p>
          <p>
            Apresentamos o <strong>Projeto Girando a Ampulheta da Vida</strong>, um material complementar à disciplina de
            <strong>Atendimento a Tentativas de Suicídio</strong>, oferecido nos cursos de formação do
            <strong>Corpo de Bombeiros Militar de Minas Gerais</strong>.
          </p>
          <p>
            Por meio de <em>três séries exclusivas</em>, este podcast fornece ferramentas práticas e reflexões essenciais que unem
            <strong>técnica</strong>, <strong>empatia</strong> e <strong>humanidade</strong>, preparando você para abordar de forma segura e eficaz.
          </p>
          <ul>
            <li><strong>Série 1:</strong> Abordagem Técnica – Comunicação que salva.</li>
            <li><strong>Série 2:</strong> Engrenagens do Comportamento Suicida.</li>
            <li><strong>Série 3:</strong> Prevenção e Transformação de Vidas.</li>
          </ul>
          <p><strong>Aperte o play</strong> e descubra como este aprendizado pode ampliar sua atuação profissional e fazer a diferença na vida de quem mais precisa.</p>
          <p style="margin-top: 20px"><em>Abraços,</em><br /><strong>Richelmy Murta, Major BM</strong><br />Coordenador de ATS</p>
        </div>
      </section>

      <!-- Pastas (renderizadas via JS a partir da fonte de dados única) -->
      <section class="folders-container" id="folders" aria-label="Pastas de Áudios"></section>

      <!-- Áudios -->
      <section class="audio-container" id="audio-container" aria-label="Contêiner de Áudios">
        <div class="tip" id="audio-tip" hidden>
          Dica: o player retoma automaticamente de onde você parou.
        </div>
        <div id="audio-list"></div>
      </section>

      <!-- Feedback -->
      <section class="feedback-section" aria-label="Seção de Feedback">
        <p>Gostou do conteúdo? Envie-nos seu feedback:</p>
        <a
          href="https://wa.me/5535984640729?text=Ol%C3%A1%2C%20gostaria%20de%20dar%20um%20feedback%20sobre%20o%20projeto%20Girando%20a%20Ampulheta%20da%20Vida."
          target="_blank"
          rel="noopener"
          class="feedback-button"
          role="button"
        >
          <img src="https://img.icons8.com/ios-filled/50/ffffff/feedback.png" alt="Feedback" style="width:24px;height:24px" loading="lazy" />
          Enviar Feedback
        </a>
      </section>
    </main>

    <footer>
      <div class="footer-text">
        <p>Richelmy Murta, Major BM, CBMMG © 2025</p>
        <p>Coordenador e Instrutor de Atendimento a Tentativas de Suicídio (ATS)</p>
        <p>Todos os direitos reservados</p>
      </div>
    </footer>

    <!-- Biblioteca Anime.js para animações -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" defer></script>

    <!-- Script Principal -->
    <script defer>
      document.addEventListener("DOMContentLoaded", () => {
        /* ==========================
           FONTE ÚNICA DE DADOS
           (títulos, imagens e TODOS os áudios)
        ========================== */
        const SERIES = {
          1: {
            title: "Abordagem Técnica: Comunicação que salva!",
            img: "https://i.pinimg.com/736x/46/a2/33/46a2335ebc2074b6df9a9774ce9cfd5d.jpg",
            alt: "Abordagens Técnicas",
          },
          2: {
            title: "Engrenagens do Comportamento Suicida",
            img: "https://i.pinimg.com/736x/51/e8/8c/51e88c0d477d8812200af68229bf66d7.jpg",
            alt: "Razões Multicausais",
          },
          3: {
            title: "Prevenção e Transformação de Vidas",
            img: "https://i.pinimg.com/736x/1f/68/67/1f6867294fd6c1b101f2fdab626e658b.jpg",
            alt: "Prevenção no CBMMG",
          },
        };

        const AUDIOS = {
          1: [
            { title: "A1 001: Abordagem Técnica - comunicação que salva!", url: "https://github.com/ricmurtapsicologia/Podcast-ATS-CBMMG/raw/refs/heads/main/001%20Aborgagem%20T%C3%A9cnica%20-%20comunica%C3%A7%C3%A3o%20que%20salva!.mp3.mp3" },
            { title: "A1 002: Comportamentos Desejáveis na Abordagem Técnica", url: "https://github.com/ricmurtapsicologia/Podcast-ATS-CBMMG/raw/refs/heads/main/002%20Comportamentos%20Desej%C3%A1veis%20na%20Abordagem%20T%C3%A9cnica.mp3.mp3" },
            { title: "A1 003: Comportamentos que Devem Ser Evitados na Abordagem Técnica", url: "https://github.com/ricmurtapsicologia/Podcast-ATS-CBMMG/raw/refs/heads/main/003%20Comportamentos%20que%20Devem%20Ser%20Evitados%20na%20Abordagem%20T%C3%A9cnica.mp3.mp3" },
            { title: "A1 004: A Aproximação Segura no Atendimento a Tentativas de Suicídio", url: "https://github.com/ricmurtapsicologia/Podcast-ATS-CBMMG/raw/refs/heads/main/004%20A%20Aproxima%C3%A7%C3%A3o%20Segura%20no%20Atendimento%20a%20Tentativas%20de%20Suic%C3%ADdio.mp3.mp3" },
            { title: "A1 005: O Poder de Ouvir", url: "https://github.com/ricmurtapsicologia/Podcast-ATS-CBMMG/raw/refs/heads/main/005%20O%20Poder%20de%20Ouvir.mp3.mp3" },
            { title: "A1 006: A Apresentação Pessoal - A Primeira Conexão", url: "https://github.com/ricmurtapsicologia/Podcast-ATS-CBMMG/raw/refs/heads/main/006%20A%20Apresenta%C3%A7%C3%A3o%20Pessoal%20A%20Primeira%20Conex%C3%A3o.mp3.mp3" },
            { title: "A1 007: Perguntas Simples - Rastreando Fatores de Risco e Proteção", url: "https://github.com/ricmurtapsicologia/Podcast-ATS-CBMMG/raw/refs/heads/main/007%20Perguntas%20Simples%20-%20%20Rastreando%20Fatores%20de%20Risco%20e%20Prote%C3%A7%C3%A3o.mp3.mp3" },
            { title: "A1 008: Usando Perguntas Simples com Tentante de Perfil Depressivo", url: "https://github.com/ricmurtapsicologia/Podcast-ATS-CBMMG/raw/refs/heads/main/008%20Usando%20Perguntas%20Simples%20com%20Tentante%20de%20Perfil%20Depressivo.mp3.mp3" },
            { title: "A1 009: Usando Perguntas Simples com Tentante de Perfil Agressivo", url: "https://github.com/ricmurtapsicologia/Podcast-ATS-CBMMG/raw/refs/heads/main/009%20Usando%20Perguntas%20Simples%20com%20Tentante%20de%20Perfil%20Agressivo.mp3.mp3" },
            { title: "A1 010: Usando Perguntas Simples com Tentante de Perfil Psicótico", url: "https://github.com/ricmurtapsicologia/Podcast-ATS-CBMMG/raw/refs/heads/main/010%20Usando%20Perguntas%20Simples%20com%20Tentante%20de%20Perfil%20Psic%C3%B3tico.mp3.mp3" },
            { title: "A1 011: Usando Perguntas Complexas para Apoiar o Tentante", url: "https://github.com/ricmurtapsicologia/Podcast-ATS-CBMMG/raw/refs/heads/main/011%20Usando%20Perguntas%20Complexas%20para%20Apoiar%20o%20Tentante.mp3.mp3" },
            { title: "A1 012: Ferramentas de Diálogo Influenciando a Reflexão do Tentante", url: "https://github.com/ricmurtapsicologia/Podcast-ATS-CBMMG/raw/refs/heads/main/012%20Ferramentas%20de%20Di%C3%A1logo%20Influenciando%20a%20Reflex%C3%A3o%20do%20Tentante.mp3.mp3" },
            { title: "A1 013: Técnica do Sucesso Anterior - Resgatando Estratégias do Passado", url: "https://github.com/ricmurtapsicologia/Podcast-ATS-CBMMG/raw/refs/heads/main/013%20T%C3%A9cnica%20do%20Sucesso%20Anterior%20Resgatando%20Estrat%C3%A9gias%20do%20Passado.mp3.mp3" },
            { title: "A1 014: Ponte para o Passado - Resgatando Memórias Agradáveis", url: "https://github.com/ricmurtapsicologia/Podcast-ATS-CBMMG/raw/refs/heads/main/014%20Ponte%20para%20o%20Passado%20Resgatando%20Mem%C3%B3rias%20Agrad%C3%A1veis.mp3.mp3" },
            { title: "A1 015: Ponte para o Futuro - Criando Perspectivas Positivas", url: "https://github.com/ricmurtapsicologia/Podcast-ATS-CBMMG/raw/refs/heads/main/015%20Ponte%20para%20o%20Futuro%20Criando%20Perspectivas%20Positivas.mp3.mp3" },
            { title: "A1 016: Paráfrase Resumida - Refinando o Foco no Diálogo", url: "https://github.com/ricmurtapsicologia/Podcast-ATS-CBMMG/raw/refs/heads/main/016%20Par%C3%A1frase%20Resumida%20Refinando%20o%20Foco%20no%20Di%C3%A1logo.mp3.mp3" },
            { title: "A1 017: Especificidades para Abordar Tentantes de Perfil Depressivo", url: "https://github.com/ricmurtapsicologia/Podcast-ATS-CBMMG/raw/refs/heads/main/017%20Especificidades%20para%20Abordar%20Tentantes%20de%20Perfil%20Depressivo.mp3.mp3" },
            { title: "A1 018: Especificidades para Abordar Tentantes de Perfil Agressivo", url: "https://github.com/ricmurtapsicologia/Podcast-ATS-CBMMG/raw/refs/heads/main/018%20Especificidades%20para%20Abordar%20Tentantes%20de%20Perfil%20Agressivo.mp3.mp3" },
            { title: "A1 019: Especificidades para Abordar Tentantes de Perfil Psicótico", url: "https://github.com/ricmurtapsicologia/Podcast-ATS-CBMMG/raw/refs/heads/main/019%20Especificidades%20para%20Abordar%20Tentantes%20de%20Perfil%20Psic%C3%B3tico.mp3.mp3" },
            { title: "A1 020: Entrada Forçada - Quando a Segurança Exige Ação", url: "https://github.com/ricmurtapsicologia/Podcast-ATS-CBMMG/raw/refs/heads/main/020%20Entrada%20For%C3%A7ada%20Quando%20a%20Seguran%C3%A7a%20Exige%20A%C3%A7%C3%A3o.mp3.mp3" },
            { title: "A1 021: Encerramento - Continuemos a Girar a Ampulheta da Vida", url: "https://github.com/ricmurtapsicologia/Podcast-ATS-CBMMG/raw/refs/heads/main/021%20Encerramento%20Continuemos%20a%20Girar%20a%20Ampulheta%20da%20Vida.mp3.mp3" },
          ],
          2: [
            { title: "A2 000: Desvendando as Engrenagens", url: "https://raw.githubusercontent.com/ricmurtapsicologia/Podcast-ATS-CBMMG/main/A2%20000%20Desvendando%20as%20Engrenagens%20do%20Comportamento%20Suicida.mp3" },
            { title: "A2 001: O Suicídio ao Longo da História", url: "https://raw.githubusercontent.com/ricmurtapsicologia/Podcast-ATS-CBMMG/main/A2%20001%20A%20Origem%20do%20Suic%C3%ADdio.mp3" },
            { title: "A2 002: Decisões no Caos: O Cérebro em Crise", url: "https://raw.githubusercontent.com/ricmurtapsicologia/Podcast-ATS-CBMMG/main/A2%20002%20Os%20Bastidores%20do%20C%C3%A9rebro.mp3" },
            { title: "A2 003: Transtornos Mentais e o Peso do Sofrimento", url: "https://raw.githubusercontent.com/ricmurtapsicologia/Podcast-ATS-CBMMG/main/A2%20003%20O%20Peso%20da%20Mente.mp3" },
            { title: "A2 004: Maria e as Sombras da Depressão", url: "https://raw.githubusercontent.com/ricmurtapsicologia/Podcast-ATS-CBMMG/main/A2%20004%20Maria%20e%20as%20sombras%20da%20depressao.mp3" },
            { title: "A2 005: Cláudio e os Ciclos da Bipolaridade", url: "https://raw.githubusercontent.com/ricmurtapsicologia/Podcast-ATS-CBMMG/main/A2%20005%20Cl%C3%A1udio%20e%20os%20Ciclos%20do%20TAB.mp3" },
            { title: "A2 006: Fernanda e o Labirinto da Cocaína", url: "https://raw.githubusercontent.com/ricmurtapsicologia/Podcast-ATS-CBMMG/main/A2%20006%20Fernanda%20na%20Rede%20da%20Depend%C3%AAncia.mp3" },
            { title: "A2 007: Programa em Foco - Saúde Mental: Júlia e o Desafio do Borderline", url: "https://raw.githubusercontent.com/ricmurtapsicologia/Podcast-ATS-CBMMG/main/A2%20007%20Entrevista%20com%20J%C3%BAlia.mp3" },
            { title: "A2 008: Programa em Foco - Saúde Mental: Dra. Sara e os Transtornos de Personalidade", url: "https://raw.githubusercontent.com/ricmurtapsicologia/Podcast-ATS-CBMMG/main/A2%20008%20Entrevista%20com%20Dra%20Sara.mp3" },
            { title: "A2 009: Dona Lurdes, Mônica e os Desafios da Esquizofrenia", url: "https://raw.githubusercontent.com/ricmurtapsicologia/Podcast-ATS-CBMMG/main/A2%20009%20Dona%20Lurdes%20e%20sua%20irm%C3%A3.mp3" },
            { title: "A2 010: As Vulnerabilidades Invisíveis: Um Olhar Filosófico e Social", url: "https://raw.githubusercontent.com/ricmurtapsicologia/Podcast-ATS-CBMMG/main/A2%20010%20Fatores%20Invis%C3%ADveis%20Vulnerabilidades%20Sociais%20e%20Filos%C3%B3ficas.mp3" },
            { title: "A2 011: Quando as Emoções Dominam", url: "https://raw.githubusercontent.com/ricmurtapsicologia/Podcast-ATS-CBMMG/main/A2%20011%20Quando%20o%20C%C3%A9rebro%20Quebra.mp3" },
            { title: "A2 012: A Ação Antes da Razão", url: "https://raw.githubusercontent.com/ricmurtapsicologia/Podcast-ATS-CBMMG/main/A2%20012%20A%20Impulsividade%20e%20o%20Comportamento%20de%20Fuga.mp3" },
            { title: "A2 013: Um Novo Olhar para as Engrenagens", url: "https://raw.githubusercontent.com/ricmurtapsicologia/Podcast-ATS-CBMMG/main/A3%20013%20Um%20Novo%20Olhar%20para%20as%20Engrenagens.mp3" },
          ],
          3: [
            { title: "Série Em construção 1", url: "https://example.com/audio-folder3-1.mp3" },
            { title: "Série Em construção 2", url: "https://example.com/audio-folder3-2.mp3" },
          ],
        };

        /* ==========================
           ELEMENTOS E ESTADO
        ========================== */
        const headerEl = document.querySelector("header");
        const mainEl = document.querySelector("main");
        const footerEl = document.querySelector("footer");
        const onboarding = document.getElementById("onboarding");
        const introBtn = document.getElementById("intro-btn");
        const introContainer = document.getElementById("intro-container");
        const onboardPrev = document.getElementById("onboard-prev");
        const onboardNext = document.getElementById("onboard-next");
        const onboardSkip = document.getElementById("onboard-skip");
        const dontShowAgain = document.getElementById("dont-show-again");

        const foldersContainer = document.getElementById("folders");
        const audioContainer = document.getElementById("audio-container");
        const audioList = document.getElementById("audio-list");
        const audioTip = document.getElementById("audio-tip");

        let currentFolder = null;
        let audioElements = [];

        /* ==========================
           ONBOARDING (salvo no localStorage)
        ========================== */
        const LS_KEYS = {
          ONBOARD_DONE: "gav:onboard_done",
          PROGRESS: (url) => `gav:progress:${url}`,
          LAST_FOLDER: "gav:last_folder",
        };

        const openApp = () => {
          onboarding.style.display = "none";
          [headerEl, mainEl, footerEl].forEach((el) => {
            el.style.display = "";
            el.style.opacity = 0;
          });
          if (window.anime) {
            anime({ targets: [headerEl, mainEl, footerEl], opacity: [0, 1], translateY: [20, 0], duration: 700, easing: "easeOutQuad" });
          } else {
            [headerEl, mainEl, footerEl].forEach((el) => (el.style.opacity = 1));
          }
        };

        const startOnboarding = () => {
          // Esconde app
          [headerEl, mainEl, footerEl].forEach((el) => (el.style.display = "none"));
          onboarding.style.display = "flex";
          onboarding.style.opacity = 0;
          if (window.anime) {
            anime({ targets: "#onboarding", opacity: [0, 1], duration: 500, easing: "easeInOutQuad" });
          } else {
            onboarding.style.opacity = 1;
          }

          // Lógica dos slides
          let currentSlide = 1;
          const totalSlides = 5;

          const showSlide = (slideIndex) => {
            for (let i = 1; i <= totalSlides; i++) {
              const slide = document.getElementById(`slide-${i}`);
              slide.style.display = i === slideIndex ? "block" : "none";
            }

            if (slideIndex === 1) {
              onboardPrev.style.display = "none";
              onboardNext.style.display = "none";
              onboardSkip.style.display = "inline-block";
              const delayTime = window.innerWidth < 768 ? 3000 : 2000;
              setTimeout(() => {
                currentSlide = 2;
                showSlide(currentSlide);
              }, delayTime);
            } else {
              onboardPrev.style.display = "inline-block";
              onboardNext.style.display = "inline-block";
              onboardSkip.style.display = "inline-block";
              onboardPrev.disabled = false;
              onboardNext.textContent = slideIndex === totalSlides ? "Concluir" : "Seguir";
            }

            // Animação sutil
            const currentSlideEl = document.getElementById(`slide-${slideIndex}`);
            if (window.anime) {
              currentSlideEl.style.opacity = 0;
              anime({ targets: currentSlideEl, opacity: [0, 1], translateY: [18, 0], duration: 450, easing: "easeInOutQuad" });
            }
          };

          showSlide(currentSlide);

          onboardPrev.onclick = () => { if (currentSlide > 2) { currentSlide--; showSlide(currentSlide); } };
          onboardNext.onclick = () => {
            if (currentSlide < totalSlides) {
              currentSlide++;
              showSlide(currentSlide);
            } else {
              if (dontShowAgain.checked) localStorage.setItem(LS_KEYS.ONBOARD_DONE, "1");
              openApp();
            }
          };
          onboardSkip.onclick = () => { if (dontShowAgain.checked) localStorage.setItem(LS_KEYS.ONBOARD_DONE, "1"); openApp(); };
        };

        if (localStorage.getItem(LS_KEYS.ONBOARD_DONE) === "1") openApp();
        else startOnboarding();

        /* ==========================
           INTRO (toggle)
        ========================== */
        const toggleIntro = () => {
          const willOpen = introContainer.style.display !== "block";
          if (willOpen) {
            introContainer.style.display = "block";
            introContainer.style.opacity = 0;
            if (window.anime) {
              anime({ targets: "#intro-container", opacity: [0, 1], duration: 450, easing: "easeInOutQuad" });
            } else {
              introContainer.style.opacity = 1;
            }
            introBtn.innerHTML = `<img src="https://img.icons8.com/ios-filled/50/ffffff/info.png" alt="Ocultar Introdução" /> Ocultar Introdução`;
            introBtn.setAttribute("aria-expanded", "true");
          } else {
            if (window.anime) {
              anime({ targets: "#intro-container", opacity: [1, 0], duration: 350, easing: "easeInOutQuad", complete: () => { introContainer.style.display = "none"; } });
            } else {
              introContainer.style.display = "none";
            }
            introBtn.innerHTML = `<img src="https://img.icons8.com/ios-filled/50/ffffff/idea.png" alt="Introdução" /> Clique aqui para conhecer o Projeto Agora!`;
            introBtn.setAttribute("aria-expanded", "false");
          }
        };
        introBtn.addEventListener("click", toggleIntro);

        /* ==========================
           RENDERIZAÇÃO DE PASTAS
        ========================== */
        const renderFolders = () => {
          foldersContainer.innerHTML = "";
          Object.keys(SERIES).forEach((id) => {
            const data = SERIES[id];
            const article = document.createElement("article");
            article.className = "folder";
            article.setAttribute("role", "button");
            article.setAttribute("tabindex", "0");
            article.dataset.folder = id;
            article.innerHTML = `
              <img src="${data.img}" alt="${data.alt}" loading="lazy" />
              <h2>${data.title}</h2>
            `;
            article.addEventListener("click", () => toggleAudios(id));
            article.addEventListener("keydown", (e) => {
              if (e.key === "Enter" || e.key === " ") toggleAudios(id);
            });
            foldersContainer.appendChild(article);
          });
        };

        /* ==========================
           UTILITÁRIOS DE ÁUDIO
        ========================== */
        const pauseOthers = (current) => {
          audioElements.forEach((a) => { if (a !== current && !a.paused) a.pause(); });
        };
        const saveProgress = (url, currentTime) => {
          try { localStorage.setItem(LS_KEYS.PROGRESS(url), String(currentTime || 0)); } catch (e) {}
        };
        const loadProgress = (url) => {
          try { return parseFloat(localStorage.getItem(LS_KEYS.PROGRESS(url)) || "0"); } catch (e) { return 0; }
        };

        /* ==========================
           RENDERIZAÇÃO DE ÁUDIOS
        ========================== */
        const ensureBackButton = () => {
          let backToFolders = audioContainer.querySelector(".back-to-folders");
          if (!backToFolders) {
            backToFolders = document.createElement("button");
            backToFolders.className = "back-to-folders";
            backToFolders.innerHTML = `
              <svg xmlns="http://www.w3.org/2000/svg" fill="#FFD700" viewBox="0 0 24 24" stroke="currentColor" style="width:24px;height:24px;vertical-align:middle">
                <path d="M10 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2h-8l-2-2z"/>
              </svg>
              <span style="vertical-align:middle;margin-left:8px;font-size:1.06rem;font-weight:700">Voltar às Pastas</span>`;
            backToFolders.addEventListener("click", () => {
              if (window.anime) {
                anime({ targets: audioContainer, opacity: [1, 0], duration: 350, easing: "easeInOutQuad", complete: () => {
                  audioContainer.style.display = "none";
                  document.querySelectorAll(".folder").forEach((f) => (f.style.display = "block"));
                  currentFolder = null;
                  localStorage.removeItem(LS_KEYS.LAST_FOLDER);
                }});
              } else {
                audioContainer.style.display = "none";
                document.querySelectorAll(".folder").forEach((f) => (f.style.display = "block"));
                currentFolder = null;
                localStorage.removeItem(LS_KEYS.LAST_FOLDER);
              }
            });
            audioContainer.appendChild(backToFolders);
          }
        };

        const toggleAudios = (folderId) => {
          if (currentFolder === folderId && audioContainer.style.display === "block") {
            if (window.anime) {
              anime({ targets: audioContainer, opacity: [1, 0], duration: 350, easing: "easeInOutQuad", complete: () => {
                audioContainer.style.display = "none";
                currentFolder = null;
                localStorage.removeItem(LS_KEYS.LAST_FOLDER);
              }});
            } else {
              audioContainer.style.display = "none";
              currentFolder = null;
              localStorage.removeItem(LS_KEYS.LAST_FOLDER);
            }
            return;
          }

          // Limpa lista e estado
          audioList.innerHTML = "";
          audioElements = [];

          // Renderiza episódios
          (AUDIOS[folderId] || []).forEach((audio, idx) => {
            const section = document.createElement("div");
            section.className = "audio-section";
            const audioId = `audio-${folderId}-${idx}`;
            const saved = loadProgress(audio.url);

            section.innerHTML = `
              <h3>${audio.title}</h3>
              <div class="audio-controls">
                <audio id="${audioId}" controls preload="metadata" aria-label="${audio.title}">
                  <source src="${audio.url}" type="audio/mpeg" />
                  Seu navegador não suporta o elemento de áudio. <a href="${audio.url}" download>Baixar</a>
                </audio>
              </div>
              <div class="audio-meta">
                <span data-role="status">${saved > 0 ? `Retomar a partir de ${formatTime(saved)}` : "Novo"}</span>
                <a href="${audio.url}" download>Baixar arquivo</a>
                <button type="button" data-role="reset">Zerar progresso</button>
              </div>
            `;

            const audioEl = section.querySelector("audio");
            const statusEl = section.querySelector('[data-role="status"]');
            const resetBtn = section.querySelector('[data-role="reset"]');

            // Ao carregar metadados, posiciona no último progresso
            audioEl.addEventListener("loadedmetadata", () => {
              const again = loadProgress(audio.url);
              if (!Number.isNaN(again) && again > 0 && again < audioEl.duration - 2) {
                audioEl.currentTime = again;
                audioTip.hidden = false;
                statusEl.textContent = `Retomar a partir de ${formatTime(again)}`;
              }
            });

            // Salva progresso periodicamente
            audioEl.addEventListener("timeupdate", () => {
              saveProgress(audio.url, audioEl.currentTime || 0);
              statusEl.textContent = `Em ${formatTime(audioEl.currentTime || 0)}`;
            });

            // Pausa os outros ao dar play
            audioEl.addEventListener("play", () => pauseOthers(audioEl));

            // Se terminar, zera progresso
            audioEl.addEventListener("ended", () => {
              saveProgress(audio.url, 0);
              statusEl.textContent = "Concluído";
            });

            // Reset manual
            resetBtn.addEventListener("click", () => {
              saveProgress(audio.url, 0);
              audioEl.currentTime = 0;
              statusEl.textContent = "Novo";
            });

            audioElements.push(audioEl);
            audioList.appendChild(section);
          });

          ensureBackButton();

          // Exibe container e esconde pastas
          audioContainer.style.display = "block";
          audioContainer.style.opacity = 0;
          if (window.anime) {
            anime({ targets: audioContainer, opacity: [0, 1], duration: 350, easing: "easeInOutQuad" });
          } else {
            audioContainer.style.opacity = 1;
          }
          currentFolder = folderId;
          localStorage.setItem(LS_KEYS.LAST_FOLDER, String(folderId));
          document.querySelectorAll(".folder").forEach((folderEl) => (folderEl.style.display = "none"));
          audioContainer.scrollIntoView({ behavior: "smooth", block: "start" });
        };

        window.toggleAudios = toggleAudios; // opcional

        /* ==========================
           HELPERS
        ========================== */
        function formatTime(seconds) {
          const s = Math.floor(seconds || 0);
          const m = Math.floor(s / 60);
          const r = s % 60;
          return `${String(m).padStart(2, "0")}:${String(r).padStart(2, "0")}`;
        }

        // Render inicial
        renderFolders();

        // Se havia uma pasta aberta anteriormente, restaura
        const lastFolder = localStorage.getItem(LS_KEYS.LAST_FOLDER);
        if (lastFolder && AUDIOS[lastFolder]) toggleAudios(lastFolder);
      });
    </script>
  </body>
</html>

